<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Smart Food Delivery App Prototype</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
    <style>
:root {
  --color-bg: #f2f6f3;
  --color-surface: #ffffff;
  --color-surface-alt: #e7f1eb;
  --color-primary: #2d7a56;
  --color-primary-hover: #256648;
  --color-primary-light: #57b287;
  --color-accent: #4aa86b;
  --color-text: #1f2a24;
  --color-muted: #5a6c60;
  --color-border: #d5e0d8;
  --color-input-bg: #ffffff;
  --color-input-text: #1f2a24;
  --color-on-primary: #ffffff;
  --color-secondary-text: #2d7a56;
  --color-secondary-hover: rgba(87, 178, 135, 0.18);
  --color-focus-outline: rgba(87, 178, 135, 0.24);
  --color-focus-ring: rgba(87, 178, 135, 0.6);
  --scrollbar-thumb: rgba(45, 122, 86, 0.4);
  --shadow-sm: 0 6px 18px rgba(41, 71, 54, 0.08);
  --radius-lg: 20px;
  --radius-md: 14px;
  --radius-sm: 8px;
  --transition: 0.2s ease;
}

body[data-theme='dark'] {
  --color-bg: #101812;
  --color-surface: #17241d;
  --color-surface-alt: #1f2f25;
  --color-primary: #2f9f6f;
  --color-primary-hover: #3ab880;
  --color-primary-light: #49c891;
  --color-accent: #6ed09d;
  --color-text: #f1f7f2;
  --color-muted: #b8c7bd;
  --color-border: #2a3a31;
  --color-input-bg: #203329;
  --color-input-text: #f1f7f2;
  --color-on-primary: #0b1f15;
  --color-secondary-text: #6ed09d;
  --color-secondary-hover: rgba(110, 208, 157, 0.18);
  --color-focus-outline: rgba(110, 208, 157, 0.35);
  --color-focus-ring: rgba(110, 208, 157, 0.7);
  --scrollbar-thumb: rgba(110, 208, 157, 0.45);
  --shadow-sm: 0 6px 18px rgba(0, 0, 0, 0.35);
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  color: var(--color-text);
  background: var(--color-bg);
  line-height: 1.6;
}

img {
  max-width: 100%;
  display: block;
}

a {
  color: inherit;
}

button,
input,
select,
textarea {
  font: inherit;
  color: inherit;
}

button {
  cursor: pointer;
}

button:disabled {
  cursor: not-allowed;
  opacity: 0.6;
}

.top-bar {
  display: flex;
  flex-wrap: wrap;
  gap: 16px;
  justify-content: space-between;
  align-items: center;
  padding: 16px 20px;
  background: var(--color-surface);
  box-shadow: var(--shadow-sm);
  position: sticky;
  top: 0;
  z-index: 100;
}

.brand {
  display: flex;
  align-items: center;
  gap: 12px;
}

.brand span {
  font-size: 1.75rem;
}

.brand-name {
  font-weight: 700;
  margin: 0;
}

.brand-tagline {
  margin: 2px 0 0;
  color: var(--color-muted);
  font-size: 0.85rem;
}

.main-nav {
  display: flex;
  overflow-x: auto;
  gap: 8px;
  padding-bottom: 4px;
}

.main-nav::-webkit-scrollbar {
  display: none;
}

.nav-btn {
  border: 1px solid var(--color-border);
  background: var(--color-surface);
  color: var(--color-muted);
  padding: 10px 18px;
  border-radius: 999px;
  font-weight: 600;
  transition: background-color var(--transition), color var(--transition), border-color var(--transition);
  white-space: nowrap;
}

.nav-btn:hover,
.nav-btn:focus-visible {
  border-color: var(--color-primary);
  color: var(--color-primary);
}

.nav-btn.active {
  background: var(--color-primary);
  border-color: var(--color-primary);
  color: var(--color-on-primary);
}

main {
  flex: 1 0 auto;
  padding: 0 20px 80px;
}

.view {
  display: block;
  margin: 28px auto;
  max-width: 1080px;
}

.view[hidden] {
  display: none !important;
}

.view-header h1 {
  margin: 0 0 6px;
  font-size: 1.7rem;
}

.view-instruction {
  margin: 0;
  color: var(--color-muted);
  font-size: 0.95rem;
}

.filter-panel {
  display: grid;
  gap: 16px;
  margin: 24px 0 32px;
  padding: 16px 12px 20px; 
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-sm);
}


.field,
.field-group {
  display: flex;
  gap: 12px;
  flex-direction: column;
}

.field label {
  font-weight: 600;
}

.field input,
.field select,
.field textarea {
  padding: 12px;
  border: 1px solid var(--color-border);
  border-radius: var(--radius-sm);
  background: var(--color-input-bg);
  color: var(--color-input-text);
  transition: border-color var(--transition), background-color var(--transition), color var(--transition);
}

.field input:focus-visible,
.field select:focus-visible,
.field textarea:focus-visible {
  border-color: var(--color-primary);
  outline: none;
  box-shadow: 0 0 0 3px var(--color-focus-outline);
}

.field textarea {
  resize: vertical;
}

.field input::placeholder,
.field textarea::placeholder {
  color: var(--color-muted);
}

.output {
  font-weight: 600;
}

.toggles {
  flex-direction: row;
  gap: 20px;
  flex-wrap: wrap;
}

.toggle {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-weight: 600;
}

.toggle input {
  width: 18px;
  height: 18px;
  accent-color: var(--color-primary);
}

/* align toggle filters with card edge */
.filter-panel .toggle {
  justify-content: flex-start;
  width: 100%;
}

.filter-panel .toggle input {
  margin-left: 0;
  margin-right: 8px;
  align-self: flex-start;
}

.section-title {
  margin: 0 0 4px;
  font-size: 1.2rem;
}

.section-subtitle {
  margin: 0 0 20px;
  color: var(--color-muted);
  font-size: 0.95rem;
}

.supplier-grid {
  display: grid;
  gap: 18px;
}

.supplier-card {
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  padding: 20px;
  box-shadow: var(--shadow-sm);
  display: grid;
  gap: 14px;
  transition: transform var(--transition), box-shadow var(--transition);
}

.supplier-card:hover,
.supplier-card:focus-within {
  transform: translateY(-4px);
  box-shadow: 0 12px 24px rgba(45, 122, 86, 0.16);
}

.supplier-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}

.supplier-name {
  font-size: 1.2rem;
  margin: 0;
}

.supplier-location {
  margin: 4px 0 0;
  color: var(--color-muted);
  font-size: 0.9rem;
}

.badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  padding: 6px 10px;
  border-radius: 999px;
  font-size: 0.8rem;
  font-weight: 600;
  background: var(--color-surface-alt);
  color: var(--color-primary);
}

.supplier-meta {
  display: flex;
  gap: 16px;
  flex-wrap: wrap;
  font-size: 0.9rem;
  color: var(--color-muted);
}

.hamper-summary {
  background: var(--color-surface-alt);
  border-radius: var(--radius-md);
  padding: 16px;
  display: grid;
  gap: 6px;
}

.hamper-summary h4 {
  margin: 0;
}

.hamper-summary p {
  margin: 0;
  color: var(--color-muted);
  font-size: 0.9rem;
}

.supplier-footnote {
  margin: 0;
  font-size: 0.85rem;
  color: var(--color-muted);
}

.action-row {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
}

.primary-btn,
.secondary-btn,
.ghost-btn {
  border-radius: 999px;
  padding: 10px 20px;
  font-weight: 600;
  border: 1px solid transparent;
  transition: background-color var(--transition), color var(--transition), border-color var(--transition), box-shadow var(--transition);
}

.primary-btn {
  background: var(--color-primary);
  color: var(--color-on-primary);
}

.primary-btn:hover,
.primary-btn:focus-visible {
  background: var(--color-primary-hover);
}

.secondary-btn {
  background: var(--color-surface-alt);
  color: var(--color-secondary-text);
}

.secondary-btn:hover,
.secondary-btn:focus-visible {
  background: var(--color-secondary-hover);
}

.ghost-btn {
  background: transparent;
  border-color: var(--color-border);
  color: var(--color-text);
}

.ghost-btn:hover,
.ghost-btn:focus-visible {
  border-color: var(--color-primary);
  color: var(--color-primary);
}

.compare-panel {
  margin: 24px 0;
  display: grid;
  gap: 20px;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
}

.comparison-table-container {
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-sm);
  overflow-x: auto;
}

.comparison-table {
  width: 100%;
  border-collapse: collapse;
}

.comparison-table th,
.comparison-table td {
  padding: 14px 20px;
  text-align: left;
  border-bottom: 1px solid var(--color-border);
}

.comparison-table tbody tr:last-child th,
.comparison-table tbody tr:last-child td {
  border-bottom: none;
}

.checkout-layout {
  display: grid;
  gap: 24px;
}

.cart,
.checkout-details {
  background: var(--color-surface);
  padding: 24px;
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-sm);
}

.cart h2,
.checkout-details h2 {
  margin-top: 0;
}

.cart-list {
  list-style: none;
  padding: 0;
  margin: 0 0 18px;
  display: grid;
  gap: 16px;
}

.cart-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
  background: var(--color-surface-alt);
  border-radius: var(--radius-md);
  padding: 14px 16px;
}

.cart-item-info {
  display: grid;
  gap: 4px;
}

.cart-item-actions {
  display: flex;
  align-items: center;
  gap: 12px;
}

.cart-total {
  display: flex;
  justify-content: space-between;
  font-size: 1.1rem;
  font-weight: 700;
}

.empty-state {
  margin: 12px 0;
  color: var(--color-muted);
}

.order-status {
  min-height: 24px;
  margin-top: 12px;
  font-weight: 600;
  color: var(--color-primary);
}

.tracking-card {
  background: var(--color-surface);
  padding: 24px;
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-sm);
  display: grid;
  gap: 20px;
}

.map-placeholder {
  height: 180px;
  border-radius: var(--radius-md);
  background: linear-gradient(135deg, rgba(45, 122, 86, 0.18), rgba(87, 178, 135, 0.4));
  position: relative;
}

.map-placeholder::after {
  content: '';
  position: absolute;
  inset: 26px;
  border: 2px dashed rgba(255, 255, 255, 0.6);
  border-radius: var(--radius-md);
}

.tracking-steps {
  list-style: none;
  margin: 0;
  padding: 0;
  display: grid;
  gap: 12px;
}

.tracking-step {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 14px 18px;
  border-radius: var(--radius-md);
  background: var(--color-surface-alt);
  color: var(--color-muted);
  transition: var(--transition);
}

.tracking-detail {
  font-size: 0.9rem;
}

.tracking-step.active {
  background: rgba(87, 178, 135, 0.18);
  color: var(--color-primary);
  font-weight: 600;
}

.progress-bar {
  height: 8px;
  border-radius: 999px;
  background: rgba(45, 122, 86, 0.16);
  overflow: hidden;
}

.progress-indicator {
  height: 100%;
  width: 0;
  background: var(--color-primary);
  transition: width 0.4s ease;
}

.report-grid {
  display: grid;
  gap: 20px;
}

.report-card {
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  padding: 24px;
  box-shadow: var(--shadow-sm);
  display: grid;
  gap: 8px;
}

.report-card h2 {
  margin: 0;
}

.report-value {
  font-size: 2rem;
  font-weight: 700;
  color: var(--color-primary);
  margin: 0;
}

.report-detail {
  margin: 0;
  color: var(--color-muted);
}

.settings-grid {
  display: grid;
  gap: 20px;
}

.settings-card {
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  padding: 24px;
  box-shadow: var(--shadow-sm);
  display: grid;
  gap: 12px;
}

.settings-card h2 {
  margin: 0;
}

.settings-card p {
  margin: 0;
  color: var(--color-muted);
}


.app-footer {
  padding: 24px 20px;
  text-align: center;
  color: var(--color-muted);
  font-size: 0.85rem;
}

.nav-btn:focus-visible,
.primary-btn:focus-visible,
.secondary-btn:focus-visible,
.ghost-btn:focus-visible,
.supplier-card:focus-visible,
#reset-tracking:focus-visible {
  outline: 3px solid var(--color-focus-ring);
  outline-offset: 2px;
}

#app:focus {
  outline: none;
}

.phone-shell,
.phone-screen,
.phone-content {
  display: contents;
}

.phone-notch,
.status-bar,
.home-indicator {
  display: none;
}

#phone-frame {
  width: 100%;
  max-width: 100%;
  display: flex;
  flex-direction: column;
  background: var(--color-bg);
  transition: all 0.3s ease;
}

body.mobile-preview {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 32px 0;
  background: var(--color-bg);
  width: 100%;
  overflow: hidden;
}

body.mobile-preview #phone-frame {
  width: min(480px, calc(100vw - 36px));
  height: 1000px; 
  max-height: 120vh; 
  border-radius: 44px;
  background: linear-gradient(160deg, rgba(45, 122, 86, 0.18), rgba(87, 178, 135, 0.32));
  border: 1px solid rgba(255, 255, 255, 0.08);
  box-shadow: 0 28px 60px rgba(16, 24, 18, 0.35);
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

body.mobile-preview[data-theme='dark'] #phone-frame {
  border-color: rgba(42, 58, 49, 0.8);
  background: linear-gradient(160deg, rgba(32, 51, 41, 0.9), rgba(17, 27, 20, 0.96));
  box-shadow: 0 32px 72px rgba(0, 0, 0, 0.55);
}

body.mobile-preview .phone-shell {
  width: 100%;
  height: 100%;
  padding: 16px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
}

body.mobile-preview .phone-notch {
  display: block;
  width: 120px;
  height: 18px;
  border-radius: 0 0 20px 20px;
  background: rgba(31, 42, 36, 0.25);
  position: relative;
}

body.mobile-preview[data-theme='dark'] .phone-notch {
  background: rgba(0, 0, 0, 0.6);
}

body.mobile-preview .phone-notch::after {
  content: '';
  position: absolute;
  top: 5px;
  left: 50%;
  transform: translateX(-50%);
  width: 26px;
  height: 6px;
  border-radius: 999px;
  background: rgba(0, 0, 0, 0.28);
}

body.mobile-preview[data-theme='dark'] .phone-notch::after {
  background: rgba(255, 255, 255, 0.18);
}

body.mobile-preview .phone-screen {
  flex: 1;
  width: 100%;
  display: flex;
  flex-direction: column;
  background: var(--color-surface);
  border-radius: 28px;
  overflow: hidden;
  box-shadow: 0 18px 36px rgba(16, 24, 18, 0.2);
  border: 1px solid rgba(255, 255, 255, 0.08);
}

body.mobile-preview[data-theme='dark'] .phone-screen {
  border-color: rgba(42, 58, 49, 0.65);
}

body.mobile-preview .status-bar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 18px 6px;
  font-size: 0.78rem;
  font-weight: 600;
  letter-spacing: 0.08em;
  color: var(--color-text);
  opacity: 0.9;
}

body.mobile-preview .status-icons {
  display: flex;
  align-items: center;
  gap: 6px;
}

body.mobile-preview .status-signal,
body.mobile-preview .status-wifi,
body.mobile-preview .status-battery {
  position: relative;
  display: block;
}

body.mobile-preview .status-signal {
  width: 14px;
  height: 10px;
}

body.mobile-preview .status-signal::before {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 2px;
  height: 4px;
  background: var(--color-text);
  border-radius: 1px;
  box-shadow:
    3px -1px 0 0 var(--color-text),
    6px -3px 0 0 var(--color-text),
    9px -5px 0 0 var(--color-text);
}

body.mobile-preview .status-wifi {
  width: 14px;
  height: 10px;
}

body.mobile-preview .status-wifi::before {
  content: '';
  position: absolute;
  inset: 0;
  border: 1.5px solid var(--color-text);
  border-radius: 50%;
  border-bottom-color: transparent;
}

body.mobile-preview .status-wifi::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 4px;
  height: 4px;
  border-radius: 50%;
  background: var(--color-text);
}

body.mobile-preview .status-battery {
  width: 18px;
  height: 10px;
  border: 1.5px solid var(--color-text);
  border-radius: 3px;
  padding: 1px;
  display: flex;
  align-items: center;
}

body.mobile-preview .status-battery::after {
  content: '';
  position: absolute;
  top: 3px;
  right: -3px;
  width: 2px;
  height: 4px;
  border-radius: 1px;
  background: var(--color-text);
}

body.mobile-preview .status-battery-level {
  width: 70%;
  height: 100%;
  border-radius: 2px;
  background: var(--color-text);
}

body.mobile-preview .phone-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow-y: auto;
  padding: 4px 18px 24px;
  gap: 0;
  scrollbar-width: thin;
  scrollbar-color: var(--scrollbar-thumb) transparent;
  scrollbar-gutter: stable both-edges;
}

body.mobile-preview .phone-content::-webkit-scrollbar {
  width: 6px;
}

body.mobile-preview .phone-content::-webkit-scrollbar-track {
  background: transparent;
}

body.mobile-preview .phone-content::-webkit-scrollbar-thumb {
  background-color: var(--scrollbar-thumb);
  border-radius: 999px;
}

body.mobile-preview .top-bar {
  border-radius: 22px;
  margin: 0;
  position: sticky;
  top: 0;
  z-index: 100;
  box-shadow: var(--shadow-sm);
  padding: 14px 16px;
}

body.mobile-preview main#app {
  padding: 0;
  width: 100%;
  flex: 1 0 auto;
}

.supplier-grid {
  display: grid;
  gap: 18px;
}

body.mobile-preview .view {
  margin: 18px 0;
  max-width: 100%;
  width: 100%;
}

body.mobile-preview .supplier-grid {
  grid-template-columns: 1fr;
  gap: 18px;
}

body.mobile-preview .filter-panel {
  display: flex;
  flex-direction: column;
  gap: 16px;
  padding: 18px 16px;
}

body.mobile-preview .field-group {
  flex-direction: column;
  gap: 14px;
}

body.mobile-preview .field,
body.mobile-preview .field-group .field {
  width: 100%;
}

body.mobile-preview .filter-panel .field input,
body.mobile-preview .filter-panel .field select,
body.mobile-preview .filter-panel .field textarea {
  width: 100%;
}

body.mobile-preview .toggles {
  flex-direction: column;
  align-items: flex-start;
  gap: 12px;
}

body.mobile-preview .toggle {
  width: 100%;
  justify-content: flex-start;
}

body.mobile-preview .toggle span {
  flex: 0 1 auto;
}

body.mobile-preview .checkout-layout {
  grid-template-columns: 1fr;
  gap: 16px;
}

body.mobile-preview .report-grid {
  grid-template-columns: 1fr;
  gap: 16px;
}

body.mobile-preview .app-footer {
  width: 100%;
  border-radius: 0 0 26px 26px;
  padding: 18px 16px;
  background: var(--color-surface-alt);
}

body.mobile-preview .main-nav {
  justify-content: flex-start;
  gap: 8px;
  padding: 8px 0 0;
  overflow-x: auto;
}

body.mobile-preview .home-indicator {
  display: block;
  width: 100px;
  height: 5px;
  border-radius: 999px;
  background: rgba(31, 42, 36, 0.28);
}

body.mobile-preview[data-theme='dark'] .home-indicator {
  background: rgba(241, 247, 242, 0.35);
}

@media (min-width: 720px) {
  .filter-panel {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  .field-group {
    flex-direction: row;
    align-items: flex-end;
  }

  .field-group .field {
    flex: 1;
  }
}

@media (min-width: 960px) {
  .supplier-grid {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  .checkout-layout {
    grid-template-columns: minmax(0, 1.1fr) minmax(0, 0.9fr);
    align-items: start;
  }

  .report-grid {
    grid-template-columns: repeat(3, minmax(0, 1fr));
  }
}

</style>
  </head>
  <body>
    <div id="phone-frame">
      <div class="phone-shell">
        <div class="phone-notch" aria-hidden="true"></div>
        <div class="phone-screen">
          <div class="status-bar" aria-hidden="true">
            <span class="status-time">9:41</span>
            <div class="status-icons" aria-hidden="true">
              <span class="status-signal"></span>
              <span class="status-wifi"></span>
              <span class="status-battery"><span class="status-battery-level"></span></span>
            </div>
          </div>
          <div class="phone-content">
    <header class="top-bar">
      <div class="brand">
        <span aria-hidden="true">&#129379;</span>
      <div>
        <p class="brand-name" data-i18n="brandName">Smart Food Delivery</p>
        <p class="brand-tagline" data-i18n="brandTagline">Sustainable meals for remote communities</p>
      </div>
      </div>
      <nav class="main-nav" aria-label="Primary" data-i18n-aria-label="navAriaLabel">
        <button class="nav-btn" data-target="home-view" data-i18n="navSearch">Search</button>
        <button class="nav-btn" data-target="compare-view" data-i18n="navCompare">Compare</button>
        <button class="nav-btn" data-target="checkout-view" data-i18n="navCheckout">Checkout</button>
        <button class="nav-btn" data-target="tracking-view" data-i18n="navTracking">Tracking</button>
        <button class="nav-btn" data-target="report-view" data-i18n="navReport">Report</button>
        <button class="nav-btn" data-target="settings-view" data-i18n="navSettings">Settings</button>
      </nav>
    </header>

    <main id="app" tabindex="-1">
      <section id="home-view" class="view active" aria-labelledby="home-title">
        <header class="view-header">
          <h1 id="home-title" data-i18n="homeTitle">Find nearby food suppliers</h1>
          <p class="view-instruction" data-i18n="homeInstruction">Task 1: Use the filters to locate affordable, low-carbon options that deliver to your area.</p>
        </header>

        <form id="filter-form" class="filter-panel" aria-label="Search filters" data-i18n-aria-label="filtersAriaLabel">
          <div class="field">
            <label for="search-input" data-i18n="searchLabel">Search by name or location</label>
            <input id="search-input" type="search" data-i18n-placeholder="searchPlaceholder" placeholder="Try 'Outback' or 'Remote'" />
          </div>

          <div class="field-group">
            <div class="field">
              <label for="price-filter" data-i18n="priceLabel">Price band</label>
              <select id="price-filter">
                <option value="all" data-i18n="priceAny">Any</option>
                <option value="$" data-i18n="priceLow">$ - Lowest cost</option>
                <option value="$$" data-i18n="priceMid">$$ - Balanced</option>
                <option value="$$$" data-i18n="priceHigh">$$$ - Premium</option>
              </select>
            </div>

            <div class="field">
              <label for="distance-filter" data-i18n="distanceLabel">Max distance (km)</label>
              <input id="distance-filter" type="range" min="5" max="60" value="40" step="5" />
              <output id="distance-output" for="distance-filter">40 km</output>
            </div>
          </div>

          <div class="field toggles">
            <label class="toggle">
              <input id="surplus-toggle" type="checkbox" />
              <span data-i18n="surplusLabel">Show surplus food offers only</span>
            </label>
            <label class="toggle">
              <input id="delivery-toggle" type="checkbox" checked />
              <span data-i18n="deliveryLabel">Delivery available</span>
            </label>
          </div>
        </form>

        <section aria-live="polite" aria-atomic="true">
          <h2 class="section-title" data-i18n="suppliersTitle">Suppliers near you</h2>
          <p class="section-subtitle" data-i18n="suppliersSubtitle">Tap a card to compare or add a community hamper to your cart.</p>
          <div id="supplier-grid" class="supplier-grid"></div>
        </section>
      </section>

      <section id="compare-view" class="view" aria-labelledby="compare-title" hidden>
        <header class="view-header">
          <h1 id="compare-title" data-i18n="compareTitle">Compare suppliers</h1>
          <p class="view-instruction" data-i18n="compareInstruction">Task 2: Choose two suppliers to see how they differ in freshness, price, and emissions.</p>
        </header>

        <div class="compare-panel">
          <div class="field">
            <label for="compare-a" data-i18n="compareSupplierA">Supplier A</label>
            <select id="compare-a"></select>
          </div>
          <div class="field">
            <label for="compare-b" data-i18n="compareSupplierB">Supplier B</label>
            <select id="compare-b"></select>
          </div>
        </div>

        <div class="comparison-table-container">
          <table class="comparison-table" aria-describedby="compare-title">
            <thead>
              <tr>
                <th scope="col" data-i18n="compareMetricHeading">Metric</th>
                <th scope="col" id="compare-name-a">Supplier A</th>
                <th scope="col" id="compare-name-b">Supplier B</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th scope="row" data-i18n="compareMetricPrice">Price</th>
                <td data-metric="price-a"></td>
                <td data-metric="price-b"></td>
              </tr>
              <tr>
                <th scope="row" data-i18n="compareMetricFreshness">Freshness score</th>
                <td data-metric="freshness-a"></td>
                <td data-metric="freshness-b"></td>
              </tr>
              <tr>
                <th scope="row" data-i18n="compareMetricCO2">Delivery CO2 impact</th>
                <td data-metric="co2-a"></td>
                <td data-metric="co2-b"></td>
              </tr>
              <tr>
                <th scope="row" data-i18n="compareMetricDistance">Distance</th>
                <td data-metric="distance-a"></td>
                <td data-metric="distance-b"></td>
              </tr>
              <tr>
                <th scope="row" data-i18n="compareMetricSurplus">Surplus food</th>
                <td data-metric="surplus-a"></td>
                <td data-metric="surplus-b"></td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <section id="checkout-view" class="view" aria-labelledby="checkout-title" hidden>
        <header class="view-header">
          <h1 id="checkout-title" data-i18n="checkoutTitle">Review and place your order</h1>
          <p class="view-instruction" data-i18n="checkoutInstruction">Task 3: Confirm the items in your hamper, then place the order to start tracking.</p>
        </header>

        <div class="checkout-layout">
          <section class="cart" aria-label="Cart contents" data-i18n-aria-label="cartAriaLabel">
            <h2 data-i18n="cartSummary">Cart summary</h2>
            <ul id="cart-list" class="cart-list"></ul>
            <p id="cart-empty" class="empty-state" data-i18n="cartEmpty">Your hamper is empty. Add items from the search view.</p>
            <div class="cart-total">
              <span data-i18n="totalLabel">Total</span>
              <strong id="cart-total">$0.00</strong>
            </div>
          </section>

          <section class="checkout-details" aria-label="Delivery preferences" data-i18n-aria-label="deliveryAriaLabel">
            <h2 data-i18n="deliveryPreferences">Delivery preferences</h2>
            <div class="field">
              <label for="delivery-window" data-i18n="deliveryWindow">Delivery window</label>
              <select id="delivery-window">
                <option value="11:00 - 13:00" data-i18n="deliveryWindowMorning">11:00 - 13:00</option>
                <option value="13:00 - 15:00" data-i18n="deliveryWindowAfternoon">13:00 - 15:00</option>
                <option value="17:00 - 19:00" data-i18n="deliveryWindowEvening">17:00 - 19:00</option>
              </select>
            </div>

            <div class="field">
              <label for="contact-note" data-i18n="driverNote">Driver note</label>
              <textarea id="contact-note" rows="3" data-i18n-placeholder="driverNotePlaceholder" placeholder="Add directions or access notes"></textarea>
            </div>

            <button id="place-order" class="primary-btn" type="button" disabled data-i18n="placeOrder">Place order</button>
            <p id="order-status" class="order-status" role="status" aria-live="polite"></p>
            <button id="go-to-tracking" class="secondary-btn" type="button" hidden data-i18n="goToTracking">Go to tracking</button>
          </section>
        </div>
      </section>

      <section id="tracking-view" class="view" aria-labelledby="tracking-title" hidden>
        <header class="view-header">
          <h1 id="tracking-title" data-i18n="trackingTitle">Track your delivery</h1>
          <p class="view-instruction" data-i18n="trackingInstruction">Task 3 (continued): Follow the delivery stages to monitor when food arrives.</p>
        </header>

        <section class="tracking-card" aria-live="polite">
          <div class="map-placeholder" role="img" aria-label="Stylised delivery map with highlighted route" data-i18n-aria-label="mapAriaLabel"></div>
          <ol class="tracking-steps" id="tracking-steps"></ol>
          <div class="progress-bar" aria-hidden="true">
            <div id="progress-indicator" class="progress-indicator"></div>
          </div>
          <button id="reset-tracking" class="secondary-btn" type="button" data-i18n="trackingRestart">Restart tracking demo</button>
        </section>
      </section>

      <section id="report-view" class="view" aria-labelledby="report-title" hidden>
        <header class="view-header">
          <h1 id="report-title" data-i18n="reportTitle">Savings & sustainability report</h1>
          <p class="view-instruction" data-i18n="reportInstruction">Optional Task: Review your impact after ordering surplus community hampers.</p>
        </header>

        <div class="report-grid">
          <article class="report-card">
            <h2 data-i18n="reportSavingsTitle">Money saved</h2>
            <p class="report-value" id="report-savings">$0.00</p>
            <p class="report-detail" data-i18n="reportSavingsDetail">Compared to standard metropolitan deliveries.</p>
          </article>
          <article class="report-card">
            <h2 data-i18n="reportCo2Title">CO2 avoided</h2>
            <p class="report-value" id="report-co2">0.0 kg</p>
            <p class="report-detail" data-i18n="reportCo2Detail">Estimated from lower delivery distances and surplus rescue.</p>
          </article>
          <article class="report-card">
            <h2 data-i18n="reportMealsTitle">Meals rescued</h2>
            <p class="report-value" id="report-meals">0</p>
            <p class="report-detail" data-i18n="reportMealsDetail">Surplus portions diverted from waste this month.</p>
          </article>
        </div>
      </section>

      <section id="settings-view" class="view" aria-labelledby="settings-title" hidden>
        <header class="view-header">
          <h1 id="settings-title" data-i18n="settingsTitle">Settings</h1>
          <p class="view-instruction" data-i18n="settingsInstruction">Adjust theme, language, and preview mode for your study participants.</p>
        </header>

        <div class="settings-grid">
          <article class="settings-card">
            <h2 data-i18n="appearanceHeading">Appearance</h2>
            <p data-i18n="appearanceDescription">Switch between day and night modes to test readability.</p>
            <button id="theme-toggle" class="primary-btn" type="button">Switch to night mode</button>
          </article>

          <article class="settings-card">
            <h2 data-i18n="languageHeading">Language</h2>
            <p data-i18n="languageDescription">Preview the interface in multiple languages.</p>
            <div class="field">
              <label for="language-select" data-i18n="languageLabel">Interface language</label>
              <select id="language-select"></select>
            </div>
          </article>

          <article class="settings-card">
            <h2 data-i18n="previewHeading">Mobile preview</h2>
            <p data-i18n="previewDescription">Simulate the phone layout inside the browser.</p>
            <button id="mobile-toggle" class="secondary-btn" type="button">Enable mobile frame</button>
          </article>
        </div>
      </section>
    </main>

    <footer class="app-footer">
      <p data-i18n="footerNote">INFO3315 Smart Food Delivery Prototype &middot; Designed for remote community resilience</p>
    </footer>
          </div>
        </div>
        <div class="home-indicator" aria-hidden="true"></div>
      </div>
    </div>

    <script>
const suppliers = [
  {
    id: 'outback-grocer',
    name: 'Outback Grocer',
    location: 'Alice Springs, NT',
    price: '$',
    averageBasket: 24.5,
    distance: 12,
    surplus: true,
    delivery: true,
    co2: 8,
    freshness: 8,
    description: 'Family-run grocer partnering with remote community hubs for surplus distribution.',
    items: [
      {
        id: 'outback-hamper',
        name: 'Remote Essentials Hamper',
        price: 24.5,
        servings: 4,
        savings: 12,
        co2Saved: 2.1,
        meals: 4,
        notes: 'Staples rescued from metro surplus: oats, long-life milk, bush herbs, seasonal produce.'
      }
    ]
  },
  {
    id: 'green-market',
    name: 'Green Market',
    location: 'Broken Hill, NSW',
    price: '$$',
    averageBasket: 32.0,
    distance: 5,
    surplus: false,
    delivery: true,
    co2: 6,
    freshness: 9,
    description: 'Hydroponic growers delivering weekly produce boxes using solar-powered vans.',
    items: [
      {
        id: 'green-harvest',
        name: 'Hydro Harvest Pack',
        price: 32,
        servings: 5,
        savings: 8,
        co2Saved: 1.3,
        meals: 5,
        notes: 'Leafy greens, tomatoes, and herbs grown with recycled water.'
      }
    ]
  },
  {
    id: 'remote-foods',
    name: 'Remote Foods',
    location: 'Katherine, NT',
    price: '$',
    averageBasket: 22.0,
    distance: 30,
    surplus: true,
    delivery: true,
    co2: 5,
    freshness: 7,
    description: 'Community co-op aggregating surplus produce from regional farms.',
    items: [
      {
        id: 'remote-hamper',
        name: 'Community Pantry Box',
        price: 22,
        servings: 3,
        savings: 9,
        co2Saved: 2.5,
        meals: 3,
        notes: 'Tinned beans, root vegetables, fresh bread, and pantry staples.'
      }
    ]
  },
  {
    id: 'bush-bites',
    name: 'Bush Bites Collective',
    location: 'Dubbo, NSW',
    price: '$$',
    averageBasket: 29.5,
    distance: 18,
    surplus: true,
    delivery: true,
    co2: 7,
    freshness: 8,
    description: 'Aboriginal-owned collective sharing culturally significant produce and meals.',
    items: [
      {
        id: 'bush-share',
        name: 'Bush Tucker Share Pack',
        price: 29.5,
        servings: 4,
        savings: 10,
        co2Saved: 1.9,
        meals: 4,
        notes: 'Kangaroo stew, lemon myrtle damper, native greens, and seasonal fruit.'
      }
    ]
  },
  {
    id: 'sunrise-co',
    name: 'Sunrise Co-Op',
    location: 'Longreach, QLD',
    price: '$$$',
    averageBasket: 38.0,
    distance: 22,
    surplus: false,
    delivery: true,
    co2: 9,
    freshness: 9,
    description: 'Solar chilled trucks delivering protein-rich hampers to cattle stations.',
    items: [
      {
        id: 'sunrise-protein',
        name: 'Protein Boost Crate',
        price: 38,
        servings: 6,
        savings: 5,
        co2Saved: 0.8,
        meals: 6,
        notes: 'Free-range eggs, legumes, yoghurt, and seasonal fruit.'
      }
    ]
  }
];

const languageOptions = [
  { value: 'en', labelKey: 'languageEnglish' },
  { value: 'ja', labelKey: 'languageJapanese' },
  { value: 'hi', labelKey: 'languageHindi' },
  { value: 'fr', labelKey: 'languageFrench' },
  { value: 'zh', labelKey: 'languageChinese' }
];

const translations = {
  en: {
    brandTagline: 'Sustainable meals for remote communities',
    brandName: 'Smart Food Delivery',
    navSearch: 'Search',
    navCompare: 'Compare',
    navCheckout: 'Checkout',
    navTracking: 'Tracking',
    navReport: 'Report',
    navSettings: 'Settings',
    navAriaLabel: 'Primary navigation',
    homeTitle: 'Find nearby food suppliers',
    homeInstruction: 'Task 1: Use the filters to locate affordable, low-carbon options that deliver to your area.',
    searchLabel: 'Search by name or location',
    searchPlaceholder: "Try 'Outback' or 'Remote'",
    filtersAriaLabel: 'Search filters',
    priceLabel: 'Price band',
    priceAny: 'Any',
    priceLow: '$ - Lowest cost',
    priceMid: '$$ - Balanced',
    priceHigh: '$$$ - Premium',
    distanceLabel: 'Max distance (km)',
    surplusLabel: 'Show surplus food offers only',
    deliveryLabel: 'Delivery available',
    distanceValue: '{value} km',
    suppliersTitle: 'Suppliers near you',
    suppliersSubtitle: 'Tap a card to compare or add a community hamper to your cart.',
    compareTitle: 'Compare suppliers',
    compareInstruction: 'Task 2: Choose two suppliers to see how they differ in freshness, price, and emissions.',
    compareSupplierA: 'Supplier A',
    compareSupplierB: 'Supplier B',
    compareMetricHeading: 'Metric',
    compareMetricPrice: 'Price',
    compareMetricFreshness: 'Freshness score',
    compareMetricCO2: 'Delivery CO2 impact',
    compareMetricDistance: 'Distance',
    compareMetricSurplus: 'Surplus food',
    checkoutTitle: 'Review and place your order',
    checkoutInstruction: 'Task 3: Confirm the items in your hamper, then place the order to start tracking.',
    cartSummary: 'Cart summary',
    cartEmpty: 'Your hamper is empty. Add items from the search view.',
    cartAriaLabel: 'Cart contents',
    totalLabel: 'Total',
    deliveryPreferences: 'Delivery preferences',
    deliveryAriaLabel: 'Delivery preferences',
    deliveryWindow: 'Delivery window',
    deliveryWindowMorning: '11:00 - 13:00 (midday)',
    deliveryWindowAfternoon: '13:00 - 15:00 (afternoon)',
    deliveryWindowEvening: '17:00 - 19:00 (evening)',
    driverNote: 'Driver note',
    driverNotePlaceholder: 'Add directions or access notes',
    placeOrder: 'Place order',
    goToTracking: 'Go to tracking',
    trackingTitle: 'Track your delivery',
    trackingInstruction: 'Task 3 (continued): Follow the delivery stages to monitor when food arrives.',
    trackingRestart: 'Restart tracking demo',
    mapAriaLabel: 'Stylised delivery map with highlighted route',
    reportTitle: 'Savings & sustainability report',
    reportInstruction: 'Optional Task: Review your impact after ordering surplus community hampers.',
    reportSavingsTitle: 'Money saved',
    reportSavingsDetail: 'Compared to standard metropolitan deliveries.',
    reportCo2Title: 'CO2 avoided',
    reportCo2Detail: 'Estimated from lower delivery distances and surplus rescue.',
    reportMealsTitle: 'Meals rescued',
    reportMealsDetail: 'Surplus portions diverted from waste this month.',
    footerNote: 'INFO3315 Smart Food Delivery Prototype · Designed for remote community resilience',
    settingsTitle: 'Settings',
    settingsInstruction: 'Adjust theme, language, and preview mode for your study participants.',
    appearanceHeading: 'Appearance',
    appearanceDescription: 'Switch between day and night modes to test readability.',
    languageHeading: 'Language',
    languageDescription: 'Preview the interface in multiple languages.',
    languageLabel: 'Interface language',
    previewHeading: 'Mobile preview',
    previewDescription: 'Simulate the phone layout inside the browser.',
    surplusBadge: 'Surplus rescue',
    compareAction: 'Compare supplier',
    addToCart: 'Add hamper to cart',
    deliveryAvailable: 'Delivery available',
    pickupOnly: 'Pickup only',
    supplierPriceBand: 'Price band: {price}',
    supplierDistance: '{distance} km away',
    supplierFreshness: 'Freshness score: {freshness}/10',
    supplierCo2: 'Delivery CO2: {co2} kg',
    hamperMeta: 'Feeds {servings} · Saves {savings}',
    hamperAdded: 'Hamper added. Review the details, then place your order.',
    orderPlaced: 'Order placed! Tracking has started with a shared EV route.',
    cartItemMeta: '{servings} servings · Saves {savings} · CO2 avoided {co2}',
    removeItem: 'Remove',
    noMatches: 'No suppliers match your filters. Try widening the distance or price band.',
    yes: 'Yes',
    no: 'No',
    trackingPreparingTitle: 'Preparing hamper',
    trackingPreparingDetail: 'Volunteers are sorting surplus produce and packing your box.',
    trackingDriverTitle: 'Driver assigned',
    trackingDriverDetail: 'Jade (EV van) is collecting items from the supplier hub.',
    trackingEnrouteTitle: 'On the way',
    trackingEnrouteDetail: 'Shared route to your community hub. {distance} km remaining.',
    trackingDeliveredTitle: 'Delivered',
    trackingDeliveredDetail: 'Hamper left in the community cool locker. Enjoy!',
    themeSwitchToDark: 'Switch to night mode',
    themeSwitchToLight: 'Switch to day mode',
    mobileEnable: 'Enable mobile frame',
    mobileDisable: 'Disable mobile frame',
    languageEnglish: 'English',
    languageJapanese: 'Japanese',
    languageHindi: 'Hindi',
    languageFrench: 'French',
    languageChinese: 'Chinese',
    priceAverage: '{band} (avg ${average})',
    freshnessValue: '{value}/10',
    co2Value: '{value} kg'
  },
  ja: {
    brandTagline: '遠隔地域に持続可能な食事を届けます',
    brandName: 'スマートフードデリバリー',
    navSearch: '検索',
    navCompare: '比較',
    navCheckout: '注文確認',
    navTracking: '配送状況',
    navReport: 'レポート',
    navSettings: '設定',
    navAriaLabel: 'メインナビゲーション',
    homeTitle: '近くの食料供給者を探す',
    homeInstruction: 'タスク1: フィルターを使って、配送可能で低価格・低炭素の選択肢を見つけましょう。',
    searchLabel: '名前または地域で検索',
    searchPlaceholder: '「アウトバック」や「リモート」を検索',
    filtersAriaLabel: '検索フィルター',
    priceLabel: '価格帯',
    priceAny: 'すべて',
    priceLow: '$ - 手頃',
    priceMid: '$$ - 標準',
    priceHigh: '$$$ - プレミアム',
    distanceLabel: '最大距離 (km)',
    surplusLabel: '余剰食品のみ表示',
    deliveryLabel: '配送可能',
    suppliersTitle: '近くの供給者',
    suppliersSubtitle: 'カードをタップして比較するか、共同ハンパーをカートに追加します。',
    compareTitle: '供給者を比較',
    compareInstruction: 'タスク2: 2つの供給者を選んで鮮度・価格・排出量を比較します。',
    compareSupplierA: '供給者A',
    compareSupplierB: '供給者B',
    compareMetricHeading: '指標',
    compareMetricPrice: '価格',
    compareMetricFreshness: '鮮度スコア',
    compareMetricCO2: '配送CO2',
    compareMetricDistance: '距離',
    compareMetricSurplus: '余剰食品',
    checkoutTitle: '注文内容を確認して確定',
    checkoutInstruction: 'タスク3: ハンパーを確認し、注文して追跡を開始します。',
    cartSummary: 'カート概要',
    cartEmpty: 'カートは空です。検索画面から追加してください。',
    cartAriaLabel: 'カートの内容',
    totalLabel: '合計',
    deliveryPreferences: '配送設定',
    deliveryAriaLabel: '配送設定',
    deliveryWindow: '配送時間帯',
    deliveryWindowMorning: '11:00 - 13:00 (午前)',
    deliveryWindowAfternoon: '13:00 - 15:00 (午後)',
    deliveryWindowEvening: '17:00 - 19:00 (夕方)',
    driverNote: 'ドライバーへのメモ',
    driverNotePlaceholder: '道順や連絡事項を入力',
    placeOrder: '注文を確定',
    goToTracking: '配送状況へ',
    trackingTitle: '配送状況を確認',
    trackingInstruction: 'タスク3: 配送ステップを追跡して到着を確認しましょう。',
    trackingRestart: '追跡デモを再開',
    mapAriaLabel: '配送ルートを示すスタイライズされた地図',
    reportTitle: '節約とサステナビリティレポート',
    reportInstruction: 'オプション: 余剰ハンパー注文後の効果を確認します。',
    reportSavingsTitle: '節約金額',
    reportSavingsDetail: '都市部配送との比較です。',
    reportCo2Title: '削減したCO2',
    reportCo2Detail: '短距離配送と余剰活用での推計値。',
    reportMealsTitle: '救われた食事',
    reportMealsDetail: '今月廃棄を免れた余剰食の回数。',
    footerNote: 'INFO3315 Smart Food Delivery プロトタイプ・遠隔地域のレジリエンスのために設計',
    settingsTitle: '設定',
    settingsInstruction: '研究参加者向けにテーマ、言語、プレビューを調整します。',
    appearanceHeading: '表示テーマ',
    appearanceDescription: '可読性テストのため昼夜モードを切り替えます。',
    languageHeading: '言語',
    languageDescription: 'インターフェースを複数言語で確認します。',
    languageLabel: '表示言語',
    previewHeading: 'モバイルプレビュー',
    previewDescription: 'ブラウザ内でスマートフォン表示をシミュレートします。',
    surplusBadge: '余剰食材',
    compareAction: 'この供給者を比較',
    addToCart: 'ハンパーをカートに追加',
    deliveryAvailable: '配送可能',
    pickupOnly: '受け取りのみ',
    supplierPriceBand: '価格帯: {price}',
    supplierDistance: '{distance} km先',
    supplierFreshness: '鮮度スコア: {freshness}/10',
    supplierCo2: '配送CO2: {co2} kg',
    hamperMeta: '{servings}人分 · {savings}節約',
    hamperAdded: 'ハンパーを追加しました。内容を確認して注文してください。',
    orderPlaced: '注文が確定しました。共有EVルートで配送を開始します。',
    cartItemMeta: '{servings}人分 · {savings}節約 · CO2削減 {co2}',
    removeItem: '削除',
    noMatches: '条件に一致する供給者がありません。距離や価格帯を広げてください。',
    yes: 'はい',
    no: 'いいえ',
    trackingPreparingTitle: 'ハンパー準備中',
    trackingPreparingDetail: 'ボランティアが余剰食材を仕分けして箱詰めしています。',
    trackingDriverTitle: 'ドライバーを割り当て',
    trackingDriverDetail: 'Jade（EVバン）が供給ハブで荷物を受け取ります。',
    trackingEnrouteTitle: '配送中',
    trackingEnrouteDetail: 'コミュニティハブへ向かっています。残り{distance} km。',
    trackingDeliveredTitle: 'お届け完了',
    trackingDeliveredDetail: '共同冷蔵ロッカーにハンパーをお届けしました。',
    themeSwitchToDark: 'ナイトモードに切り替え',
    themeSwitchToLight: 'デイモードに切り替え',
    mobileEnable: 'モバイル枠を有効化',
    mobileDisable: 'モバイル枠を無効化',
    languageEnglish: '英語',
    languageJapanese: '日本語',
    languageHindi: 'ヒンディー語',
    languageFrench: 'フランス語',
    languageChinese: '中国語',
    priceAverage: '{band} (平均 ${average})',
    freshnessValue: '{value}/10',
    co2Value: '{value} kg'
  },
  hi: {
    brandTagline: 'दूरदराज़ समुदायों के लिए टिकाऊ भोजन वितरण',
    brandName: 'स्मार्ट फूड डिलीवरी',
    navSearch: 'खोजें',
    navCompare: 'तुलना',
    navCheckout: 'ऑर्डर',
    navTracking: 'ट्रैकिंग',
    navReport: 'रिपोर्ट',
    navSettings: 'सेटिंग्स',
    navAriaLabel: 'मुख्य नेविगेशन',
    homeTitle: 'निकट के खाद्य आपूर्तिकर्ता खोजें',
    homeInstruction: 'कार्य 1: फ़िल्टर का उपयोग करके सस्ती, कम-कार्बन डिलीवरी विकल्प खोजें।',
    searchLabel: 'नाम या स्थान से खोजें',
    searchPlaceholder: "'आउटबैक' या 'रिमोट' तलाशें",
    filtersAriaLabel: 'खोज फ़िल्टर',
    priceLabel: 'मूल्य श्रेणी',
    priceAny: 'सभी',
    priceLow: '$ - किफायती',
    priceMid: '$$ - संतुलित',
    priceHigh: '$$$ - प्रीमियम',
    distanceLabel: 'अधिकतम दूरी (km)',
    surplusLabel: 'केवल अधिशेष भोजन दिखाएं',
    deliveryLabel: 'डिलीवरी उपलब्ध',
    suppliersTitle: 'आपके निकट के आपूर्तिकर्ता',
    suppliersSubtitle: 'तुलना करने या सामुदायिक हैम्पर को कार्ट में जोड़ने के लिए कार्ड चुनें।',
    compareTitle: 'आपूर्तिकर्ताओं की तुलना करें',
    compareInstruction: 'कार्य 2: दो आपूर्तिकर्ता चुनें और कीमत, ताजगी व उत्सर्जन तुलना करें।',
    compareSupplierA: 'आपूर्तिकर्ता A',
    compareSupplierB: 'आपूर्तिकर्ता B',
    compareMetricHeading: 'मापदंड',
    compareMetricPrice: 'मूल्य',
    compareMetricFreshness: 'ताजगी स्कोर',
    compareMetricCO2: 'डिलीवरी CO2 प्रभाव',
    compareMetricDistance: 'दूरी',
    compareMetricSurplus: 'अधिशेष भोजन',
    checkoutTitle: 'ऑर्डर की समीक्षा एवं पुष्टि',
    checkoutInstruction: 'कार्य 3: हैम्पर की समीक्षा करें, फिर ऑर्डर करें और ट्रैक करें।',
    cartSummary: 'कार्ट सारांश',
    cartEmpty: 'आपका हैम्पर खाली है। खोज दृश्य से वस्तुएं जोड़ें।',
    cartAriaLabel: 'कार्ट सामग्री',
    totalLabel: 'कुल',
    deliveryPreferences: 'डिलीवरी वरीयताएँ',
    deliveryAriaLabel: 'डिलीवरी वरीयताएँ',
    deliveryWindow: 'डिलीवरी समय',
    deliveryWindowMorning: '11:00 - 13:00 (दोपहर)',
    deliveryWindowAfternoon: '13:00 - 15:00 (दोपहर बाद)',
    deliveryWindowEvening: '17:00 - 19:00 (शाम)',
    driverNote: 'ड्राइवर नोट',
    driverNotePlaceholder: 'निर्देश या पहुंच नोट जोड़ें',
    placeOrder: 'ऑर्डर करें',
    goToTracking: 'ट्रैकिंग पर जाएं',
    trackingTitle: 'अपनी डिलीवरी ट्रैक करें',
    trackingInstruction: 'कार्य 3: डिलीवरी के चरणों को देखें और आगमन पर नज़र रखें।',
    trackingRestart: 'ट्रैकिंग डेमो पुनः प्रारंभ',
    mapAriaLabel: 'उज्ज्वल मार्ग वाला शैलीकृत डिलीवरी मानचित्र',
    reportTitle: 'बचत और स्थिरता रिपोर्ट',
    reportInstruction: 'वैकल्पिक: अधिशेष हैम्पर ऑर्डर के बाद प्रभाव देखें।',
    reportSavingsTitle: 'बचाई गई राशि',
    reportSavingsDetail: 'मानक शहरी डिलीवरी की तुलना।',
    reportCo2Title: 'टाली गई CO2',
    reportCo2Detail: 'कम दूरी और अधिशेष बचत से अनुमानित।',
    reportMealsTitle: 'बचाए गए भोजन',
    reportMealsDetail: 'इस महीने बर्बादी से बचाए गए अधिशेष भोजन।',
    footerNote: 'INFO3315 Smart Food Delivery प्रोटोटाइप · दूरस्थ समुदायों के लिए डिज़ाइन',
    settingsTitle: 'सेटिंग्स',
    settingsInstruction: 'प्रतिभागियों के लिए थीम, भाषा और पूर्वावलोकन समायोजित करें।',
    appearanceHeading: 'रूप',
    appearanceDescription: 'पठनीयता जाँचने हेतु दिन और रात मोड बदलें।',
    languageHeading: 'भाषा',
    languageDescription: 'इंटरफ़ेस को कई भाषाओं में देखें।',
    languageLabel: 'इंटरफ़ेस भाषा',
    previewHeading: 'मोबाइल पूर्वावलोकन',
    previewDescription: 'ब्राउज़र में फोन लेआउट का अनुकरण करें।',
    surplusBadge: 'अधिशेष बचाव',
    compareAction: 'आपूर्तिकर्ता तुलना करें',
    addToCart: 'हैम्पर कार्ट में जोड़ें',
    deliveryAvailable: 'डिलीवरी उपलब्ध',
    pickupOnly: 'केवल पिकअप',
    supplierPriceBand: 'मूल्य श्रेणी: {price}',
    supplierDistance: '{distance} km दूर',
    supplierFreshness: 'ताजगी स्कोर: {freshness}/10',
    supplierCo2: 'डिलीवरी CO2: {co2} kg',
    hamperMeta: '{servings} परोसें · {savings} की बचत',
    hamperAdded: 'हैम्पर जोड़ा गया। विवरण देखें और ऑर्डर करें।',
    orderPlaced: 'ऑर्डर हो गया! साझा EV मार्ग से ट्रैकिंग शुरू हुई।',
    cartItemMeta: '{servings} परोसें · {savings} की बचत · CO2 में {co2} कमी',
    removeItem: 'हटाएं',
    noMatches: 'आपके फ़िल्टर से कोई आपूर्तिकर्ता मेल नहीं खा रहा। दूरी या मूल्य सीमा बढ़ाएँ।',
    yes: 'हाँ',
    no: 'नहीं',
    trackingPreparingTitle: 'हैम्पर तैयार हो रहा',
    trackingPreparingDetail: 'स्वयंसेवक अधिशेष भोजन छांटकर पैक कर रहे हैं।',
    trackingDriverTitle: 'ड्राइवर नियत',
    trackingDriverDetail: 'Jade (EV वैन) आपूर्ति केंद्र से वस्तुएँ उठा रही है।',
    trackingEnrouteTitle: 'रास्ते में',
    trackingEnrouteDetail: 'आपके सामुदायिक केंद्र की ओर। {distance} km बाकी।',
    trackingDeliveredTitle: 'डिलीवर हो गया',
    trackingDeliveredDetail: 'समुदाय के कूल लॉकर में हैम्पर रखा गया है। आनंद लें!',
    themeSwitchToDark: 'नाइट मोड चालू करें',
    themeSwitchToLight: 'डे मोड चालू करें',
    mobileEnable: 'मोबाइल फ्रेम सक्षम करें',
    mobileDisable: 'मोबाइल फ्रेम अक्षम करें',
    languageEnglish: 'अंग्रेज़ी',
    languageJapanese: 'जापानी',
    languageHindi: 'हिन्दी',
    languageFrench: 'फ़्रेंच',
    languageChinese: 'चीनी',
    priceAverage: '{band} (औसत ${average})',
    freshnessValue: '{value}/10',
    co2Value: '{value} किग्रा'
  },
  fr: {
    brandTagline: 'Des repas durables pour les communautés isolées',
    brandName: 'Livraison Alimentaire Intelligente',
    navSearch: 'Recherche',
    navCompare: 'Comparer',
    navCheckout: 'Commande',
    navTracking: 'Suivi',
    navReport: 'Rapport',
    navSettings: 'Paramètres',
    navAriaLabel: 'Navigation principale',
    homeTitle: 'Trouver des fournisseurs proches',
    homeInstruction: 'Tâche 1 : utilisez les filtres pour trouver des options abordables et peu carbonées livrées chez vous.',
    searchLabel: 'Rechercher par nom ou lieu',
    searchPlaceholder: "Essayez 'Outback' ou 'Remote'",
    filtersAriaLabel: 'Filtres de recherche',
    priceLabel: 'Tranche de prix',
    priceAny: 'Toutes',
    priceLow: '$ - Économique',
    priceMid: '$$ - Équilibré',
    priceHigh: '$$$ - Premium',
    distanceLabel: 'Distance maximale (km)',
    surplusLabel: 'Afficher uniquement les surplus',
    deliveryLabel: 'Livraison disponible',
    suppliersTitle: 'Fournisseurs à proximité',
    suppliersSubtitle: 'Touchez une carte pour comparer ou ajouter un panier solidaire.',
    compareTitle: 'Comparer les fournisseurs',
    compareInstruction: 'Tâche 2 : choisissez deux fournisseurs pour comparer prix, fraîcheur et émissions.',
    compareSupplierA: 'Fournisseur A',
    compareSupplierB: 'Fournisseur B',
    compareMetricHeading: 'Critère',
    compareMetricPrice: 'Prix',
    compareMetricFreshness: 'Indice de fraîcheur',
    compareMetricCO2: 'Impact CO2 livraison',
    compareMetricDistance: 'Distance',
    compareMetricSurplus: 'Surplus',
    checkoutTitle: 'Vérifier et valider la commande',
    checkoutInstruction: 'Tâche 3 : vérifiez votre panier puis validez pour lancer le suivi.',
    cartSummary: 'Récapitulatif du panier',
    cartEmpty: 'Votre panier est vide. Ajoutez des articles depuis la recherche.',
    cartAriaLabel: 'Contenu du panier',
    totalLabel: 'Total',
    deliveryPreferences: 'Préférences de livraison',
    deliveryAriaLabel: 'Préférences de livraison',
    deliveryWindow: 'Créneau de livraison',
    deliveryWindowMorning: '11:00 - 13:00 (midi)',
    deliveryWindowAfternoon: '13:00 - 15:00 (après-midi)',
    deliveryWindowEvening: '17:00 - 19:00 (soir)',
    driverNote: 'Note pour le livreur',
    driverNotePlaceholder: 'Ajouter des indications ou un code d’accès',
    placeOrder: 'Valider la commande',
    goToTracking: 'Aller au suivi',
    trackingTitle: 'Suivre la livraison',
    trackingInstruction: 'Tâche 3 : suivez les étapes de livraison pour connaître l’arrivée.',
    trackingRestart: 'Relancer la démo de suivi',
    mapAriaLabel: 'Carte stylisée de livraison avec itinéraire mis en évidence',
    reportTitle: 'Rapport économies & durabilité',
    reportInstruction: 'Optionnel : mesurez votre impact après les paniers surplus.',
    reportSavingsTitle: 'Économies réalisées',
    reportSavingsDetail: 'Comparé à une livraison urbaine standard.',
    reportCo2Title: 'CO2 évité',
    reportCo2Detail: 'Estimation grâce aux distances réduites et aux surplus sauvés.',
    reportMealsTitle: 'Repas sauvés',
    reportMealsDetail: 'Portions de surplus détournées du gaspillage ce mois-ci.',
    footerNote: 'Prototype INFO3315 Smart Food Delivery · Conçu pour la résilience des communautés isolées',
    settingsTitle: 'Paramètres',
    settingsInstruction: 'Ajustez thème, langue et aperçu pour vos participants.',
    appearanceHeading: 'Apparence',
    appearanceDescription: 'Basculez entre mode jour et nuit pour tester la lisibilité.',
    languageHeading: 'Langue',
    languageDescription: 'Apercevez l’interface en plusieurs langues.',
    languageLabel: 'Langue de l’interface',
    previewHeading: 'Aperçu mobile',
    previewDescription: 'Simulez l’affichage téléphone dans le navigateur.',
    surplusBadge: 'Surplus',
    compareAction: 'Comparer ce fournisseur',
    addToCart: 'Ajouter le panier',
    deliveryAvailable: 'Livraison disponible',
    pickupOnly: 'Retrait uniquement',
    supplierPriceBand: 'Tranche de prix : {price}',
    supplierDistance: '{distance} km',
    supplierFreshness: 'Indice de fraîcheur : {freshness}/10',
    supplierCo2: 'CO2 livraison : {co2} kg',
    hamperMeta: '{servings} portions · Économies {savings}',
    hamperAdded: 'Panier ajouté. Vérifiez les détails puis validez.',
    orderPlaced: 'Commande validée ! Le suivi EV partagé a commencé.',
    cartItemMeta: '{servings} portions · Économies {savings} · CO2 évité {co2}',
    removeItem: 'Retirer',
    noMatches: 'Aucun fournisseur ne correspond. Élargissez la distance ou le prix.',
    yes: 'Oui',
    no: 'Non',
    trackingPreparingTitle: 'Préparation du panier',
    trackingPreparingDetail: 'Les bénévoles trient les surplus et emballent votre commande.',
    trackingDriverTitle: 'Livreur assigné',
    trackingDriverDetail: 'Jade (fourgonnette EV) récupère les produits au hub.',
    trackingEnrouteTitle: 'En route',
    trackingEnrouteDetail: 'Trajet partagé vers votre hub communautaire. {distance} km restants.',
    trackingDeliveredTitle: 'Livré',
    trackingDeliveredDetail: 'Panier déposé dans le casier frigorifique communautaire. Bon appétit !',
    themeSwitchToDark: 'Passer en mode nuit',
    themeSwitchToLight: 'Passer en mode jour',
    mobileEnable: 'Activer le cadre mobile',
    mobileDisable: 'Désactiver le cadre mobile',
    languageEnglish: 'Anglais',
    languageJapanese: 'Japonais',
    languageHindi: 'Hindi',
    languageFrench: 'Français',
    languageChinese: 'Chinois',
    priceAverage: '{band} (moy. ${average})',
    freshnessValue: '{value}/10',
    co2Value: '{value} kg'
  },
  zh: {
    brandTagline: '为偏远社区提供可持续的餐食配送',
    brandName: '智慧食品配送',
    navSearch: '搜索',
    navCompare: '对比',
    navCheckout: '下单',
    navTracking: '追踪',
    navReport: '报告',
    navSettings: '设置',
    navAriaLabel: '主导航',
    homeTitle: '查找附近的食物供应商',
    homeInstruction: '任务1：使用筛选器寻找价格实惠、可配送且低碳的选择。',
    searchLabel: '按名称或位置搜索',
    searchPlaceholder: '试试搜索“Outback”或“Remote”',
    filtersAriaLabel: '搜索筛选',
    priceLabel: '价格区间',
    priceAny: '不限',
    priceLow: '$ - 经济',
    priceMid: '$$ - 适中',
    priceHigh: '$$$ - 高端',
    distanceLabel: '最大距离 (km)',
    surplusLabel: '仅显示余量食品',
    deliveryLabel: '提供配送',
    distanceValue: '{value} 公里',
    suppliersTitle: '附近的供应商',
    suppliersSubtitle: '点选卡片即可对比或将社区套餐加入购物车。',
    compareTitle: '比较供应商',
    compareInstruction: '任务2：选择两个供应商，比较价格、鲜度和碳排。',
    compareSupplierA: '供应商A',
    compareSupplierB: '供应商B',
    compareMetricHeading: '指标',
    compareMetricPrice: '价格',
    compareMetricFreshness: '鲜度评分',
    compareMetricCO2: '配送CO2',
    compareMetricDistance: '距离',
    compareMetricSurplus: '余量食品',
    checkoutTitle: '确认并提交订单',
    checkoutInstruction: '任务3：确认套餐内容，然后下单并开始追踪。',
    cartSummary: '购物车摘要',
    cartEmpty: '购物车为空，请从搜索界面添加。',
    cartAriaLabel: '购物车内容',
    totalLabel: '合计',
    deliveryPreferences: '配送偏好',
    deliveryAriaLabel: '配送偏好',
    deliveryWindow: '配送时间',
    deliveryWindowMorning: '11:00 - 13:00 (中午)',
    deliveryWindowAfternoon: '13:00 - 15:00 (下午)',
    deliveryWindowEvening: '17:00 - 19:00 (傍晚)',
    driverNote: '骑手备注',
    driverNotePlaceholder: '添加路线或门禁说明',
    placeOrder: '提交订单',
    goToTracking: '前往追踪',
    trackingTitle: '追踪配送',
    trackingInstruction: '任务3：跟随配送阶段，掌握到货时间。',
    trackingRestart: '重新开始追踪演示',
    mapAriaLabel: '带高亮路线的配送示意图',
    reportTitle: '节约与可持续报告',
    reportInstruction: '可选：查看订购余量套餐后的影响。',
    reportSavingsTitle: '节省金额',
    reportSavingsDetail: '相较于城市标准配送。',
    reportCo2Title: '减少的CO2',
    reportCo2Detail: '基于更短配送距离与余量利用的估算。',
    reportMealsTitle: '挽救的餐食',
    reportMealsDetail: '本月避免浪费的余量份数。',
    footerNote: 'INFO3315 智慧食品配送原型·助力偏远社区韧性',
    settingsTitle: '设置',
    settingsInstruction: '根据参与者调整主题、语言与预览模式。',
    appearanceHeading: '外观主题',
    appearanceDescription: '在日间与夜间模式间切换以测试可读性。',
    languageHeading: '界面语言',
    languageDescription: '以多种语言预览界面。',
    languageLabel: '请选择语言',
    previewHeading: '手机预览',
    previewDescription: '在浏览器中模拟手机界面。',
    surplusBadge: '余量优选',
    compareAction: '对比该供应商',
    addToCart: '添加套餐到购物车',
    deliveryAvailable: '提供配送',
    pickupOnly: '仅限自提',
    supplierPriceBand: '价格区间：{price}',
    supplierDistance: '距离 {distance} 公里',
    supplierFreshness: '鲜度：{freshness}/10',
    supplierCo2: '配送CO2：{co2} 公斤',
    hamperMeta: '可供 {servings} 人 · 节省 {savings}',
    hamperAdded: '已加入套餐，请确认后下单。',
    orderPlaced: '订单已提交！共享EV路线开始配送。',
    cartItemMeta: '共 {servings} 人份 · 节省 {savings} · 减排 {co2}',
    removeItem: '移除',
    noMatches: '没有符合筛选条件的供应商，请放宽距离或价格。',
    yes: '是',
    no: '否',
    trackingPreparingTitle: '准备套餐',
    trackingPreparingDetail: '志愿者正在分拣余量食材并装箱。',
    trackingDriverTitle: '骑手已安排',
    trackingDriverDetail: 'Jade（电动货车）正前往供应中心取货。',
    trackingEnrouteTitle: '配送途中',
    trackingEnrouteDetail: '正前往社区驿站，剩余 {distance} 公里。',
    trackingDeliveredTitle: '配送完成',
    trackingDeliveredDetail: '套餐已放入社区冷柜，请及时取用。',
    themeSwitchToDark: '切换到夜间模式',
    themeSwitchToLight: '切换到日间模式',
    mobileEnable: '开启手机外框',
    mobileDisable: '关闭手机外框',
    languageEnglish: '英语',
    languageJapanese: '日语',
    languageHindi: '印地语',
    languageFrench: '法语',
    languageChinese: '中文',
    priceAverage: '{band}（平均 ${average}）',
    freshnessValue: '{value}/10',
    co2Value: '{value} 公斤'
  }
};

const trackingStages = [
  { id: 'preparing', titleKey: 'trackingPreparingTitle', detailKey: 'trackingPreparingDetail' },
  { id: 'driver', titleKey: 'trackingDriverTitle', detailKey: 'trackingDriverDetail' },
  { id: 'enroute', titleKey: 'trackingEnrouteTitle', detailKey: 'trackingEnrouteDetail' },
  { id: 'delivered', titleKey: 'trackingDeliveredTitle', detailKey: 'trackingDeliveredDetail' }
];

const localeLangMap = { zh: 'zh-Hans', ja: 'ja', hi: 'hi', fr: 'fr', en: 'en' };
const trackingEnrouteRemaining = '2.4';

const state = {
  activeView: 'home-view',
  cart: [],
  trackingTimer: null,
  trackingIndex: 0,
  orderPlaced: false,
  totals: {
    savings: 0,
    co2Saved: 0,
    meals: 0
  },
  theme: 'light',
  language: 'en',
  mobilePreview: false,
  filteredSuppliers: suppliers.slice()
};

const elements = {};

document.addEventListener('DOMContentLoaded', init);

function init() {
  cacheElements();
  bindNavigation();
  bindFilters();
  bindCheckout();
  bindTrackingControls();
  bindSettings();
  renderSupplierFilters();
  state.filteredSuppliers = suppliers.slice();
  handleFilterChange();
  populateComparisonSelectors();
  updateComparison();
  applyTheme();
  applyMobilePreview();
  applyTranslations();
  switchView(state.activeView);
}

function cacheElements() {
  elements.phoneFrame = document.getElementById('phone-frame');
  elements.phoneScreen = document.querySelector('.phone-screen');
  elements.phoneContent = document.querySelector('.phone-content');
  elements.app = document.getElementById('app');
  elements.navButtons = Array.from(document.querySelectorAll('.nav-btn'));
  elements.views = Array.from(document.querySelectorAll('.view'));
  elements.searchInput = document.getElementById('search-input');
  elements.priceFilter = document.getElementById('price-filter');
  elements.distanceFilter = document.getElementById('distance-filter');
  elements.distanceOutput = document.getElementById('distance-output');
  elements.surplusToggle = document.getElementById('surplus-toggle');
  elements.deliveryToggle = document.getElementById('delivery-toggle');
  elements.supplierGrid = document.getElementById('supplier-grid');
  elements.compareA = document.getElementById('compare-a');
  elements.compareB = document.getElementById('compare-b');
  elements.compareNameA = document.getElementById('compare-name-a');
  elements.compareNameB = document.getElementById('compare-name-b');
  elements.compareMetrics = {
    priceA: document.querySelector('[data-metric="price-a"]'),
    priceB: document.querySelector('[data-metric="price-b"]'),
    freshnessA: document.querySelector('[data-metric="freshness-a"]'),
    freshnessB: document.querySelector('[data-metric="freshness-b"]'),
    co2A: document.querySelector('[data-metric="co2-a"]'),
    co2B: document.querySelector('[data-metric="co2-b"]'),
    distanceA: document.querySelector('[data-metric="distance-a"]'),
    distanceB: document.querySelector('[data-metric="distance-b"]'),
    surplusA: document.querySelector('[data-metric="surplus-a"]'),
    surplusB: document.querySelector('[data-metric="surplus-b"]')
  };
  elements.cartList = document.getElementById('cart-list');
  elements.cartEmpty = document.getElementById('cart-empty');
  elements.cartTotal = document.getElementById('cart-total');
  elements.placeOrder = document.getElementById('place-order');
  elements.orderStatus = document.getElementById('order-status');
  elements.goToTracking = document.getElementById('go-to-tracking');
  elements.reportSavings = document.getElementById('report-savings');
  elements.reportCo2 = document.getElementById('report-co2');
  elements.reportMeals = document.getElementById('report-meals');
  elements.trackingSteps = document.getElementById('tracking-steps');
  elements.progressIndicator = document.getElementById('progress-indicator');
  elements.resetTracking = document.getElementById('reset-tracking');
  elements.themeToggle = document.getElementById('theme-toggle');
  elements.languageSelect = document.getElementById('language-select');
  elements.mobileToggle = document.getElementById('mobile-toggle');
}

function bindNavigation() {
  elements.navButtons.forEach((button) => {
    button.addEventListener('click', () => {
      const target = button.dataset.target;
      switchView(target);
    });
  });
}

function bindFilters() {
  if (elements.searchInput) {
    elements.searchInput.addEventListener('input', handleFilterChange);
  }
  if (elements.priceFilter) {
    elements.priceFilter.addEventListener('change', handleFilterChange);
  }
  if (elements.distanceFilter) {
    elements.distanceFilter.addEventListener('input', () => {
      updateDistanceOutput();
      handleFilterChange();
    });
  }
  if (elements.surplusToggle) {
    elements.surplusToggle.addEventListener('change', handleFilterChange);
  }
  if (elements.deliveryToggle) {
    elements.deliveryToggle.addEventListener('change', handleFilterChange);
  }
}

function bindCheckout() {
  if (elements.placeOrder) {
    elements.placeOrder.addEventListener('click', handlePlaceOrder);
  }
  if (elements.goToTracking) {
    elements.goToTracking.addEventListener('click', () => {
      switchView('tracking-view');
    });
  }
}

function bindTrackingControls() {
  if (elements.resetTracking) {
    elements.resetTracking.addEventListener('click', () => {
      resetTracking();
      startTracking();
    });
  }
}

function bindSettings() {
  if (elements.themeToggle) {
    elements.themeToggle.addEventListener('click', toggleTheme);
  }
  if (elements.languageSelect) {
    elements.languageSelect.addEventListener('change', handleLanguageChange);
  }
  if (elements.mobileToggle) {
    elements.mobileToggle.addEventListener('click', toggleMobilePreview);
  }
}

function switchView(targetId) {
  state.activeView = targetId;
  elements.views.forEach((section) => {
    const isTarget = section.id === targetId;
    section.hidden = !isTarget;
    section.classList.toggle('active', isTarget);
  });
  elements.navButtons.forEach((button) => {
    button.classList.toggle('active', button.dataset.target === targetId);
  });
  window.requestAnimationFrame(() => {
    if (elements.app) {
      elements.app.focus();
    }
  });
  if (targetId === 'tracking-view' && state.orderPlaced) {
    startTracking();
  }
}

function renderSupplierFilters() {
  updateDistanceOutput();
}

function updateDistanceOutput() {
  if (!elements.distanceOutput || !elements.distanceFilter) {
    return;
  }
  elements.distanceOutput.textContent = t('distanceValue', { value: elements.distanceFilter.value });
}

function handleFilterChange() {
  if (!elements.searchInput) {
    return;
  }
  updateDistanceOutput();
  const query = elements.searchInput.value.trim().toLowerCase();
  const price = elements.priceFilter ? elements.priceFilter.value : 'all';
  const maxDistance = elements.distanceFilter ? Number(elements.distanceFilter.value) : Number.POSITIVE_INFINITY;
  const surplusOnly = elements.surplusToggle ? elements.surplusToggle.checked : false;
  const deliveryOnly = elements.deliveryToggle ? elements.deliveryToggle.checked : false;

  const filtered = suppliers.filter((supplier) => {
    const matchesQuery = supplier.name.toLowerCase().includes(query) || supplier.location.toLowerCase().includes(query);
    const matchesPrice = price === 'all' || supplier.price === price;
    const matchesDistance = supplier.distance <= maxDistance;
    const matchesSurplus = !surplusOnly || supplier.surplus;
    const matchesDelivery = !deliveryOnly || supplier.delivery;
    return matchesQuery && matchesPrice && matchesDistance && matchesSurplus && matchesDelivery;
  });

  state.filteredSuppliers = filtered;
  renderSuppliers(filtered);
}

function renderSuppliers(list) {
  if (!elements.supplierGrid) {
    return;
  }

  if (!list || list.length === 0) {
    elements.supplierGrid.innerHTML = `<p class="empty-state">${t('noMatches')}</p>`;
    return;
  }

  const markup = list
    .map((supplier) => {
      const badge = supplier.surplus ? `<span class="badge">${t('surplusBadge')}</span>` : '';
      const deliveryText = supplier.delivery ? t('deliveryAvailable') : t('pickupOnly');
      const compareLabel = t('compareAction');
      const addLabel = t('addToCart');
      const item = supplier.items[0];
      const priceText = `$${item.price.toFixed(2)}`;
      const savingsText = `$${item.savings.toFixed(2)}`;
      const hamperMeta = t('hamperMeta', {
        price: priceText,
        servings: item.servings,
        savings: savingsText
      });
      const supplierMeta = [
        t('supplierPriceBand', { price: supplier.price }),
        t('supplierDistance', { distance: supplier.distance }),
        t('supplierFreshness', { freshness: supplier.freshness }),
        t('supplierCo2', { co2: supplier.co2 })
      ]
        .map((content) => `<span>${content}</span>`)
        .join('');

      return `
        <article class="supplier-card" data-supplier="${supplier.id}">
          <div class="supplier-header">
            <div>
              <h3 class="supplier-name">${supplier.name}</h3>
              <p class="supplier-location">${supplier.location}</p>
            </div>
            ${badge}
          </div>
          <p>${supplier.description}</p>
          <div class="supplier-meta">${supplierMeta}</div>
          <div class="hamper-summary">
            <h4>${item.name}</h4>
            <p>${item.notes}</p>
            <p><strong>${priceText}</strong> &middot; ${hamperMeta}</p>
          </div>
          <div class="action-row">
            <button class="primary-btn" data-action="add-cart" data-supplier="${supplier.id}" data-item="${item.id}">${addLabel}</button>
            <button class="secondary-btn" data-action="compare" data-supplier="${supplier.id}">${compareLabel}</button>
          </div>
          <p class="supplier-footnote">${deliveryText}</p>
        </article>
      `;
    })
    .join('');

  elements.supplierGrid.innerHTML = markup;

  elements.supplierGrid.querySelectorAll('[data-action="add-cart"]').forEach((button) => {
    button.addEventListener('click', (event) => {
      const supplierId = event.currentTarget.dataset.supplier;
      const itemId = event.currentTarget.dataset.item;
      addToCart(supplierId, itemId);
    });
  });

  elements.supplierGrid.querySelectorAll('[data-action="compare"]').forEach((button) => {
    button.addEventListener('click', (event) => {
      const supplierId = event.currentTarget.dataset.supplier;
      prepareComparison(supplierId);
    });
  });
}

function addToCart(supplierId, itemId) {
  const supplier = suppliers.find((entry) => entry.id === supplierId);
  const item = supplier ? supplier.items.find((entry) => entry.id === itemId) : null;
  if (!supplier || !item) {
    return;
  }

  state.cart.push({
    supplierId,
    itemId,
    supplierName: supplier.name,
    price: item.price,
    servings: item.servings,
    savings: item.savings,
    co2Saved: item.co2Saved,
    meals: item.meals
  });

  updateCartUI();
  switchView('checkout-view');
  if (elements.orderStatus) {
    elements.orderStatus.textContent = t('hamperAdded');
  }
}

function updateCartUI() {
  if (!elements.cartList || !elements.cartTotal || !elements.cartEmpty || !elements.placeOrder) {
    return;
  }

  const total = state.cart.reduce((sum, entry) => sum + entry.price, 0);

  if (state.cart.length === 0) {
    elements.cartList.innerHTML = '';
    elements.cartEmpty.hidden = false;
    elements.placeOrder.disabled = true;
    state.orderPlaced = false;
    if (elements.goToTracking) {
      elements.goToTracking.hidden = true;
    }
    if (elements.orderStatus) {
      elements.orderStatus.textContent = '';
    }
  } else {
    const markup = state.cart
      .map((entry, index) => {
        const savingsText = `$${entry.savings.toFixed(2)}`;
        const co2Text = `${entry.co2Saved.toFixed(1)} kg`;
        const meta = t('cartItemMeta', {
          servings: entry.servings,
          savings: savingsText,
          co2: co2Text
        });
        return `
          <li class="cart-item">
            <div class="cart-item-info">
              <strong>${entry.supplierName}</strong>
              <span>${meta}</span>
            </div>
            <div class="cart-item-actions">
              <span>$${entry.price.toFixed(2)}</span>
              <button class="ghost-btn" type="button" data-index="${index}">${t('removeItem')}</button>
            </div>
          </li>
        `;
      })
      .join('');

    elements.cartList.innerHTML = markup;
    elements.cartEmpty.hidden = true;
    elements.placeOrder.disabled = false;

    elements.cartList.querySelectorAll('[data-index]').forEach((button) => {
      button.addEventListener('click', (event) => {
        const itemIndex = Number(event.currentTarget.dataset.index);
        removeCartItem(itemIndex);
      });
    });
  }

  elements.cartTotal.textContent = `$${total.toFixed(2)}`;
  state.totals.savings = state.cart.reduce((sum, entry) => sum + entry.savings, 0);
  state.totals.co2Saved = state.cart.reduce((sum, entry) => sum + entry.co2Saved, 0);
  state.totals.meals = state.cart.reduce((sum, entry) => sum + entry.meals, 0);
  updateReport();
}

function removeCartItem(index) {
  state.cart.splice(index, 1);
  updateCartUI();
}

function handlePlaceOrder() {
  if (!elements.placeOrder || state.cart.length === 0) {
    return;
  }

  state.orderPlaced = true;
  elements.placeOrder.disabled = true;
  if (elements.orderStatus) {
    elements.orderStatus.textContent = t('orderPlaced');
  }
  if (elements.goToTracking) {
    elements.goToTracking.hidden = false;
  }
}

function populateComparisonSelectors() {
  if (!elements.compareA || !elements.compareB) {
    return;
  }
  const options = suppliers
    .map((supplier) => `<option value="${supplier.id}">${supplier.name}</option>`)
    .join('');
  elements.compareA.innerHTML = options;
  elements.compareB.innerHTML = options;
  if (suppliers.length > 0) {
    elements.compareA.selectedIndex = 0;
  }
  if (suppliers.length > 1) {
    elements.compareB.selectedIndex = 1;
  }
  elements.compareA.addEventListener('change', updateComparison);
  elements.compareB.addEventListener('change', updateComparison);
}

function prepareComparison(supplierId) {
  if (!elements.compareA || !elements.compareB) {
    return;
  }
  const currentA = elements.compareA.value;
  const currentB = elements.compareB.value;
  if (supplierId === currentA || supplierId === currentB) {
    switchView('compare-view');
    updateComparison();
    return;
  }
  elements.compareB.value = supplierId;
  switchView('compare-view');
  updateComparison();
}

function updateComparison() {
  if (!elements.compareA || !elements.compareB) {
    return;
  }
  const supplierA = suppliers.find((entry) => entry.id === elements.compareA.value) || suppliers[0];
  const supplierB = suppliers.find((entry) => entry.id === elements.compareB.value) || suppliers[1];
  if (!supplierA || !supplierB) {
    return;
  }
  if (elements.compareNameA) {
    elements.compareNameA.textContent = supplierA.name;
  }
  if (elements.compareNameB) {
    elements.compareNameB.textContent = supplierB.name;
  }
  const averageA = supplierA.averageBasket.toFixed(2);
  const averageB = supplierB.averageBasket.toFixed(2);
  elements.compareMetrics.priceA.textContent = t('priceAverage', {
    band: supplierA.price,
    average: averageA
  });
  elements.compareMetrics.priceB.textContent = t('priceAverage', {
    band: supplierB.price,
    average: averageB
  });
  elements.compareMetrics.freshnessA.textContent = t('freshnessValue', { value: supplierA.freshness });
  elements.compareMetrics.freshnessB.textContent = t('freshnessValue', { value: supplierB.freshness });
  elements.compareMetrics.co2A.textContent = t('co2Value', { value: supplierA.co2 });
  elements.compareMetrics.co2B.textContent = t('co2Value', { value: supplierB.co2 });
  elements.compareMetrics.distanceA.textContent = t('distanceValue', { value: supplierA.distance });
  elements.compareMetrics.distanceB.textContent = t('distanceValue', { value: supplierB.distance });
  elements.compareMetrics.surplusA.textContent = supplierA.surplus ? t('yes') : t('no');
  elements.compareMetrics.surplusB.textContent = supplierB.surplus ? t('yes') : t('no');
}

function startTracking() {
  resetTracking();
  state.trackingIndex = 0;
  updateTrackingUI();
  state.trackingTimer = window.setInterval(() => {
    state.trackingIndex += 1;
    if (state.trackingIndex >= trackingStages.length) {
      clearInterval(state.trackingTimer);
      state.trackingTimer = null;
      state.trackingIndex = trackingStages.length - 1;
    }
    updateTrackingUI();
  }, 3000);
}

function resetTracking() {
  if (state.trackingTimer) {
    clearInterval(state.trackingTimer);
    state.trackingTimer = null;
  }
  state.trackingIndex = 0;
  updateTrackingUI();
}

function renderTrackingSteps() {
  if (!elements.trackingSteps) {
    return;
  }
  const markup = trackingStages
    .map((stage) => {
      const detail = stage.detailKey === 'trackingEnrouteDetail'
        ? t(stage.detailKey, { distance: trackingEnrouteRemaining })
        : t(stage.detailKey);
      return `
        <li class="tracking-step" data-stage="${stage.id}">
          <span>${t(stage.titleKey)}</span>
          <span class="tracking-detail">${detail}</span>
        </li>
      `;
    })
    .join('');
  elements.trackingSteps.innerHTML = markup;
}

function updateTrackingUI() {
  if (!elements.trackingSteps || !elements.progressIndicator) {
    return;
  }
  const steps = Array.from(elements.trackingSteps.querySelectorAll('.tracking-step'));
  steps.forEach((step, index) => {
    step.classList.toggle('active', index <= state.trackingIndex);
  });
  const progress = (state.trackingIndex / (trackingStages.length - 1)) * 100;
  elements.progressIndicator.style.width = `${progress}%`;
}

function updateReport() {
  if (elements.reportSavings) {
    elements.reportSavings.textContent = `$${state.totals.savings.toFixed(2)}`;
  }
  if (elements.reportCo2) {
    elements.reportCo2.textContent = `${state.totals.co2Saved.toFixed(1)} kg`;
  }
  if (elements.reportMeals) {
    elements.reportMeals.textContent = `${state.totals.meals}`;
  }
}

function applyTheme() {
  document.body.dataset.theme = state.theme;
  updateThemeToggleLabel();
}

function toggleTheme() {
  state.theme = state.theme === 'light' ? 'dark' : 'light';
  applyTheme();
}

function updateThemeToggleLabel() {
  if (!elements.themeToggle) {
    return;
  }
  elements.themeToggle.textContent = state.theme === 'light' ? t('themeSwitchToDark') : t('themeSwitchToLight');
  elements.themeToggle.setAttribute('aria-pressed', state.theme === 'dark');
}

function applyMobilePreview() {
  elements.phoneScreen = document.querySelector('.phone-screen');
  elements.phoneContent = document.querySelector('.phone-content');
  document.body.classList.toggle('mobile-preview', state.mobilePreview);
  if (elements.phoneFrame) {
    elements.phoneFrame.scrollTop = 0;
  }
  if (elements.phoneContent) {
    elements.phoneContent.scrollTop = 0;
  }
  if (elements.phoneScreen) {
    elements.phoneScreen.scrollTop = 0;
  }
  updateMobileToggleLabel();
}

function toggleMobilePreview() {
  state.mobilePreview = !state.mobilePreview;
  applyMobilePreview();
}

function updateMobileToggleLabel() {
  if (!elements.mobileToggle) {
    return;
  }
  elements.mobileToggle.textContent = state.mobilePreview ? t('mobileDisable') : t('mobileEnable');
  elements.mobileToggle.setAttribute('aria-pressed', state.mobilePreview);
}

function renderLanguageOptions() {
  if (!elements.languageSelect) {
    return;
  }
  const options = languageOptions
    .map((option) => `<option value="${option.value}">${t(option.labelKey)}</option>`)
    .join('');
  elements.languageSelect.innerHTML = options;
  elements.languageSelect.value = state.language;
}

function handleLanguageChange(event) {
  const newLanguage = event.target.value;
  if (!translations[newLanguage]) {
    return;
  }
  state.language = newLanguage;
  applyTranslations();
}

function applyTranslations() {
  document.documentElement.lang = localeLangMap[state.language] || state.language;

  document.querySelectorAll('[data-i18n]').forEach((element) => {
    const key = element.getAttribute('data-i18n');
    element.textContent = t(key);
  });

  document.querySelectorAll('[data-i18n-placeholder]').forEach((element) => {
    const key = element.getAttribute('data-i18n-placeholder');
    element.setAttribute('placeholder', t(key));
  });

  document.querySelectorAll('[data-i18n-aria-label]').forEach((element) => {
    const key = element.getAttribute('data-i18n-aria-label');
    element.setAttribute('aria-label', t(key));
  });

  elements.phoneScreen = document.querySelector('.phone-screen');
  elements.phoneContent = document.querySelector('.phone-content');

  renderLanguageOptions();
  updateDistanceOutput();
  renderSuppliers(state.filteredSuppliers);
  updateCartUI();
  renderTrackingSteps();
  updateTrackingUI();
  updateComparison();
  updateThemeToggleLabel();
  updateMobileToggleLabel();
}

function t(key, vars = {}) {
  const dictionary = translations[state.language] || translations.en;
  let template = dictionary[key];
  if (template === undefined) {
    template = translations.en[key] || '';
  }
  return template.replace(/\{(.*?)\}/g, (match, token) => {
    return Object.prototype.hasOwnProperty.call(vars, token) ? vars[token] : match;
  });
}
</script>
  </body>
</html>
